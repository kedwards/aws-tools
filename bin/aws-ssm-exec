#!/usr/bin/env bash
set -euo pipefail
SCRIPT_DIR="$(cd -- "$(dirname "$(readlink -f "${BASH_SOURCE[0]}")")" && pwd)"
source "${SCRIPT_DIR}/../lib/init.sh"

# Disable pipefail before running since assume uses pipes internally
set +o pipefail

# Check if new modular function exists (rewrite branch)
if declare -f ssm_exec >/dev/null 2>&1; then
  ssm_exec "$@"
else
  # Fall back to old monolithic function (main branch)
  aws_ssm_execute_main "$@"
fi
exit $?
